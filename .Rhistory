# y coord
y<-earthRadius*((cos(theta)*sin(labmda)))
# z coord
z<-earthRadius*(sin(theta))
sqrt(((x[1]-x[2])^2)+((y[2]-y[1])^2)+((z[2]-z[1])^2))
}
chordalDistance(p1,p2,earth.radius)
library(fields)
earth.earth.radiusius = 6371
geoDistance<-function(P1, P2, earth.radius){
earth.earth.radiusius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,earthRadius)
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,eart.radius)
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,earth.radius)
library(fields)
earth.earth.radius = 6371
geoDistance<-function(P1, P2, earth.radius){
earth.earth.radiusius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
library(fields)
earth.earth.radius = 6371
geoDistance<-function(P1, P2, earth.radius){
earth.earth.radiusius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,earth.radius)
library(fields)
earth.radius = 6371
geoDistance<-function(P1, P2, earth.radius){
earth.earth.radiusius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,earth.radius)
eucDistance(p3,p4,earth.radius)
ch<-c(87.63, 41.88) # chicago
mpls<-c(93.22, 44.89) # mpls
ny<-c(73.97, 40.78) # NY
no<-c(90.25, 29.98) # New orleans
chordalDistance<-function(P1, P2, earthRadius){
theta<-c(P1[1], P2[1])
#print(theta)
labmda<-c(P1[2], P2[2])
#print(labmda)
# x coord
x<-earthRadius*(cos(theta)*cos(labmda))
# y coord
y<-earthRadius*((cos(theta)*sin(labmda)))
# z coord
z<-earthRadius*(sin(theta))
sqrt(((x[1]-x[2])^2)+((y[2]-y[1])^2)+((z[2]-z[1])^2))
}
chordalDistance(p1,p2,earth.radius)
chordalDistance(p3,p4,earth.radius)
library(fields)
earth.radius = 6371
geoDistance<-function(P1, P2, earth.radius){
earth.earth.radiusius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
rmarkdown::pandoc_version()
## 6
```{=latex}
library(fields)
earth.radius = 6371
geoDistance<-function(P1, P2, earth.radius){
earth.earth.radiusius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,earth.radius)
eucDistance(p3,p4,earth.radius)
ch<-c(87.63, 41.88) # chicago
mpls<-c(93.22, 44.89) # mpls
ny<-c(73.97, 40.78) # NY
no<-c(90.25, 29.98) # New orleans
chordalDistance<-function(P1, P2, earthRadius){
theta<-c(P1[1], P2[1])
#print(theta)
labmda<-c(P1[2], P2[2])
#print(labmda)
# x coord
x<-earthRadius*(cos(theta)*cos(labmda))
# y coord
y<-earthRadius*((cos(theta)*sin(labmda)))
# z coord
z<-earthRadius*(sin(theta))
sqrt(((x[1]-x[2])^2)+((y[2]-y[1])^2)+((z[2]-z[1])^2))
}
chordalDistance(p1,p2,earth.radius)
chordalDistance(p3,p4,earth.radius)
library(fields)
earth.radius = 6371
geoDistance<-function(P1, P2, earth.radius){
earth.earth.radiusius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,earth.radius)
eucDistance(p3,p4,earth.radius)
ch<-c(87.63, 41.88) # chicago
mpls<-c(93.22, 44.89) # mpls
ny<-c(73.97, 40.78) # NY
no<-c(90.25, 29.98) # New orleans
chordalDistance<-function(P1, P2, earthRadius){
theta<-c(P1[1], P2[1])
#print(theta)
labmda<-c(P1[2], P2[2])
#print(labmda)
# x coord
x<-earthRadius*(cos(theta)*cos(labmda))
# y coord
y<-earthRadius*((cos(theta)*sin(labmda)))
# z coord
z<-earthRadius*(sin(theta))
sqrt(((x[1]-x[2])^2)+((y[2]-y[1])^2)+((z[2]-z[1])^2))
}
chordalDistance(p1,p2,earth.radius)
chordalDistance(p3,p4,earth.radius)
library(fields)
earth.radius = 6371
geoDistance<-function(P1, P2, earthRadius){
earthRadius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
eucDistance<-function(P1, P2, earthRadius){
p1<-earthRadius*P1
p2<-earthRadius*P2
sqrt((((p2[1]-p1[1])^2)+((p2[2]-p1[2])^2)))
}
eucDistance(p1,p2,earth.radius)
eucDistance(p3,p4,earth.radius)
ch<-c(87.63, 41.88) # chicago
mpls<-c(93.22, 44.89) # mpls
ny<-c(73.97, 40.78) # NY
no<-c(90.25, 29.98) # New orleans
chordalDistance<-function(P1, P2, earthRadius){
theta<-c(P1[1], P2[1])
#print(theta)
labmda<-c(P1[2], P2[2])
#print(labmda)
# x coord
x<-earthRadius*(cos(theta)*cos(labmda))
# y coord
y<-earthRadius*((cos(theta)*sin(labmda)))
# z coord
z<-earthRadius*(sin(theta))
sqrt(((x[1]-x[2])^2)+((y[2]-y[1])^2)+((z[2]-z[1])^2))
}
chordalDistance(p1,p2,earth.radius)
chordalDistance(p3,p4,earth.radius)
library(fields)
earth.radius = 6371
geoDistance<-function(P1, P2, earthRadius){
earthRadius*acos(((sin(P1[1])*sin(P2[1])) + (cos(P1[1])*cos(P2[1])*cos(P1[2] - P2[2]))))
}
# test
# geoDistance(P1, P2, earth.earth.radiusius)
p1<-c(87.63, 41.88)# chicago
p1<-p1*(pi/180)
p2<-c(93.22, 44.89) # mpls
p2<-p2*(pi/180)
p3<-c(73.97, 40.78) # NY
p3<-p3*(pi/180)
p4<-c(90.25, 29.98) # New orleans
p4<-p4*(pi/180)
print(paste("mpls to Chicago:", geoDistance(p1, p2, earth.radius)))
print(paste("NY to new orleans: ", geoDistance(p3, p4, earth.radius)))
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
diagnostics(out)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
out
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
out<-ode(times=times, y=yini, func=rossler.eq, parms=NULL,method="lsoda")
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
y1
yini
yini$y1
yini[y1]
yini['y1']
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
out
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
out
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/main-new.r", echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
?tapply()
source("C:/Users/jackx/Desktop/cervid-farm/Cervid-Farm/R_Scripts/buffer-fencline-rand-pt.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cervid-farm/Cervid-Farm/R_Scripts/buffer-fencline-rand-pt.r", echo=TRUE)
plot(farm.full)
?st_buffer
source("C:/Users/jackx/Desktop/cervid-farm/Cervid-Farm/R_Scripts/buffer-fencline-rand-pt.r", echo=TRUE)
plot(farm.full)
source("C:/Users/jackx/Desktop/cervid-farm/Cervid-Farm/R_Scripts/buffer-fencline-rand-pt.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cervid-farm/Cervid-Farm/R_Scripts/buffer-fencline-rand-pt.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cervid-farm/Cervid-Farm/R_Scripts/buffer-fencline-rand-pt.r", echo=TRUE)
library(nimble)
library(coda)
library(spBayes)
library(geoR)
library(maptools)
library(rgdal)
## Data management
data(BEF.dat)
BEF.dat <- BEF.dat[BEF.dat$ALLBIO02_KGH>0,]
bio <- BEF.dat$ALLBIO02_KGH*0.001;
log.bio <- log(bio)
coords <- as.matrix(BEF.dat[,c("XUTM","YUTM")])
## for prediction
BEF.shp <- readOGR("./BEF-data/BEF_bound.shp")
shp2poly <- BEF.shp@polygons[[1]]@Polygons[[1]]@coords
BEF.poly <- as.matrix(shp2poly)
BEF.grids <- readGDAL("./BEF-data/dem_slope_lolosptc_clip_60.img")
pred.covars <- cbind(BEF.grids[["band1"]],
BEF.grids[["band2"]],
BEF.grids[["band3"]],
BEF.grids[["band4"]],
BEF.grids[["band5"]])
pred.covars <- cbind(rep(1, nrow(pred.covars)), pred.covars)
pred.coords <- SpatialPoints(BEF.grids)@coords
pointsInPolyOut <- pointsInPoly(BEF.poly, pred.coords)
pred.covars <- pred.covars[pointsInPolyOut,]
pred.coords <- pred.coords[pointsInPolyOut,]
## We first define nimble function to calculate covariance matrix
## for a given (exponential) covariance function
expcov <- nimbleFunction(
run = function(dist=double(2), phi=double(0), sigma2=double(0), tau2=double(0)) {
returnType(double(2))
n <- dim(dist)[1]
result <- matrix(nrow = n, ncol = n, init = FALSE)
for(i in 1:n) for(j in 1:n){
result[i, j] <- sigma2*exp(-dist[i,j]*phi)+tau2*equals(i,j)
}
return(result)
})
cExpcov <- compileNimble(expcov)
## Specify the hierarchical model
befcode <- nimbleCode({
# likelihood
for(i in 1:N) {mu[i] <- inprod(X[i,1:p],beta[1:p]) }
Sigma[1:N,1:N] <- expcov(dist[1:N,1:N],phi,sigma2,tau2)
Omega1[1:N1,1:N1] <- inverse(Sigma[1:N1,1:N1])
Y1[1:N1] ~ dmnorm(mu[1:N1], Omega1[1:N1,1:N1])
# prior
for(i in 1:p) {beta[i] ~ dnorm(0.0, sd=100)}
tau2 ~ dinvgamma(2,0.02)
sigma2 ~ dinvgamma(2,0.08)
phi ~ dunif(0.002,0.06)
# prediction
# mu0C[1:N0] <- mu[(N1+1):N] + Sigma[(N1+1):N,1:N1] %*% Omega1[1:N1,1:N1] %*% (Y1[1:N1]-mu[1:N1])
tmp[1:N0] <- Sigma[(N1+1):N,1:N1] %*% Omega1[1:N1,1:N1] %*% (Y1[1:N1]-mu[1:N1])
mu0C[1:N0] <- mu[(N1+1):N] + tmp[1:N0]
Sigma0C[1:N0,1:N0] <- Sigma[(N1+1):N,(N1+1):N] - Sigma[(N1+1):N,1:N1] %*% Omega1[1:N1,1:N1] %*%  Sigma[1:N1,(N1+1):N]
Y0[1:N0] ~ dmnorm(mu0C[1:N0],cov=Sigma0C[1:N0,1:N0])
})
## Specify data and initial values using lm estimators
## considering computational speed, we randomly select 100 points for model fitting
set.seed(9999)
rsamp <- sample(1:nrow(BEF.dat),100)
X1 <- as.matrix(cbind(1,BEF.dat[rsamp,c("ELEV","SLOPE","SUM_02_TC1","SUM_02_TC2","SUM_02_TC3")]))
Y1 <- log.bio[rsamp]
N1 <- nrow(X1)
p <- ncol(X1)
set.seed(999)
rpred <- sample(1:nrow(pred.covars),10)
X0 <- pred.covars[rpred,]
N0 <- nrow(X0)
X <- rbind(X1,X0)
dist <- iDist(rbind(coords[rsamp,],pred.coords[rpred,]))
constants <- list(N1=N1,N0=N0,N=N1+N0,p=p,X=X,dist=dist)
data <- list(Y1=Y1)
inits <- list(beta=summary(lm(Y1 ~ X1-1))$coef[,1], phi=3/200, sigma2=1, tau2=1)
## Build and Compile model
befModel <- nimbleModel(befcode, constants = constants, data = data, inits = inits)
cbefModel <- compileNimble(befModel)
confMC <- configureMCMC(befModel, monitors = c("beta","phi","sigma2","tau2","Y0"))
befMCMC <- buildMCMC(confMC)
cbefMCMC <- compileNimble(befMCMC, project = cbefModel)
## Run MCMC
MCMC.out <- runMCMC(cbefMCMC, niter=20000, nburnin=10000, nchains=3)
### convergence diagnosis
post.samples <- mcmc.list(sapply(MCMC.out,as.mcmc,simplify=FALSE))
plot(post.samples, trace=TRUE, density=FALSE)
gelman.plot(post.samples)
autocorr.plot(post.samples)
crosscorr(post.samples[,paste0("beta[",1:6,"]")])
## posterior summary
summary(post.samples)
X0
repred
rpred
X1
Y1
rsamp
log.bio
nrow(BEF.dat)
nrow(pred.covars)
repred
rpred
X1
X0
nrow(X0)
nrow(X1)
X
X0
ncol(X1)
names(X1)
colnames(X1)
?spPredict
setwd("C:/Users/jackx/Desktop/cwd-project-2")
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
setwd("C:/Users/jackx/Desktop/cwd-project-2")
read.csv("data/CWD-Positive Wild Deer_MN_2010-2023.csv")
getwd()
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
setwd("C:/Users/jackx/Desktop/cwd-project-2")
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
setwd("C:/Users/jackx/Desktop/cwd-project-2")
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
source("C:/Users/jackx/Desktop/cwd-project-2/process-data.r", echo=TRUE)
read.csv('./data/CWD-Positive-Deer-2010-2023')
read.table(
"cwd-plus-2010-2023",
sep=",", header=TRUE)
getwd()
read.table(
"cwd-plus-2010-2023",
sep=",", header=TRUE)
